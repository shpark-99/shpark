<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¿ í‚¤ ì¸ì¦ ì‹œìŠ¤í…œ</title>
    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=YOUR_APP_KEY&libraries=services,geometry"></script>
    <style>
        body { font-family: Arial, sans-serif; }
        #statusMessage { font-size: 16px; font-weight: bold; color: blue; }
        button:disabled { background-color: gray; cursor: not-allowed; }
    </style>
</head>
<body>

    <h2>ğŸª í¬ë¡¬ ì„œë“œíŒŒí‹° ì¿ í‚¤ ì°¨ë‹¨ ëŒ€ì‘ ì‹œìŠ¤í…œ</h2>

    <button id="checkCookieButton">ì¿ í‚¤ ìƒíƒœ í™•ì¸</button>
    <button id="setCookieButton">ì¿ í‚¤ ì„¤ì •</button>
    <button id="clearCookieButton">ì¿ í‚¤ ì‚­ì œ</button>

    <p id="statusMessage">â³ ì¿ í‚¤ ìƒíƒœ í™•ì¸ ì¤‘...</p>

    <script>
        const COOKIE_NAME = "auth_token";
        const STORAGE_KEY = "auth_token_storage";

        // âœ… ì„œë“œíŒŒí‹° ì¿ í‚¤ ì°¨ë‹¨ ì—¬ë¶€ ê°ì§€ í•¨ìˆ˜
        function checkThirdPartyCookies() {
            document.cookie = "test_cookie=1; SameSite=None; Secure";
            
            setTimeout(() => {
                if (!document.cookie.includes("test_cookie")) {
                    console.warn("âš  ì„œë“œíŒŒí‹° ì¿ í‚¤ê°€ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.");
                    updateStatusMessage("âš  ì„œë“œíŒŒí‹° ì¿ í‚¤ ì°¨ë‹¨ ê°ì§€ë¨! ëŒ€ì²´ ì €ì¥ ë°©ì‹ ì‚¬ìš© ì¤‘.", "red");

                    // ì¿ í‚¤ ì°¨ë‹¨ ì‹œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ë˜ëŠ” ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ë¡œ ì „í™˜
                    if (!localStorage.getItem(STORAGE_KEY)) {
                        localStorage.setItem(STORAGE_KEY, "your_auth_token_value");
                    }
                } else {
                    console.log("âœ… ì„œë“œíŒŒí‹° ì¿ í‚¤ ì‚¬ìš© ê°€ëŠ¥");
                    updateStatusMessage("âœ… ì„œë“œíŒŒí‹° ì¿ í‚¤ ì‚¬ìš© ê°€ëŠ¥", "green");
                }
            }, 500);
        }

        // âœ… CHIPS (Partitioned Cookies) ì§€ì› ì—¬ë¶€ í™•ì¸
        function checkCHIPS() {
            try {
                document.cookie = "chips_cookie=1; Partitioned; SameSite=None; Secure";
                if (document.cookie.includes("chips_cookie")) {
                    console.log("âœ… CHIPS(Partitioned Cookies) ì§€ì›ë¨.");
                    updateStatusMessage("âœ… CHIPS(Partitioned Cookies) ì§€ì›ë¨", "blue");
                } else {
                    console.warn("âš  CHIPS ë¯¸ì§€ì›. ë‹¤ë¥¸ ì €ì¥ ë°©ì‹ ê³ ë ¤ í•„ìš”.");
                }
            } catch (error) {
                console.error("âŒ CHIPS ì„¤ì • ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
            }
        }

        // âœ… ì¿ í‚¤ ì„¤ì • í•¨ìˆ˜
        function setAuthCookie() {
            if (navigator.cookieEnabled) {
                document.cookie = `${COOKIE_NAME}=your_auth_token_value; SameSite=None; Secure; max-age=3600`;
                console.log("âœ… ì¸ì¦ ì¿ í‚¤ ì„¤ì • ì™„ë£Œ");
                updateStatusMessage("âœ… ì¸ì¦ ì¿ í‚¤ê°€ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.", "green");
            } else {
                console.warn("âš  ë¸Œë¼ìš°ì €ì—ì„œ ì¿ í‚¤ê°€ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.");
                updateStatusMessage("âš  ì¿ í‚¤ê°€ ë¹„í™œì„±í™”ë¨. ë‹¤ë¥¸ ì €ì¥ ë°©ì‹ ì‚¬ìš©!", "red");

                // ì¿ í‚¤ ëŒ€ì‹  ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                localStorage.setItem(STORAGE_KEY, "your_auth_token_value");
            }
        }

        // âœ… ì¿ í‚¤ ì‚­ì œ í•¨ìˆ˜
        function clearAuthCookie() {
            document.cookie = `${COOKIE_NAME}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=None; Secure`;
            localStorage.removeItem(STORAGE_KEY);
            console.log("ğŸ—‘ ì¸ì¦ ì¿ í‚¤ ë° ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì‚­ì œ ì™„ë£Œ");
            updateStatusMessage("ğŸ—‘ ì¸ì¦ ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.", "black");
        }

        // âœ… ì¿ í‚¤ ë˜ëŠ” ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì¸ì¦ ìƒíƒœ í™•ì¸
        function checkAuthStatus() {
            if (document.cookie.includes(COOKIE_NAME)) {
                updateStatusMessage("âœ… ì¿ í‚¤ë¥¼ í†µí•œ ì¸ì¦ì´ ìœ ì§€ë˜ê³  ìˆìŠµë‹ˆë‹¤.", "green");
            } else if (localStorage.getItem(STORAGE_KEY)) {
                updateStatusMessage("âœ… ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì¸ì¦ ì‚¬ìš© ì¤‘!", "blue");
            } else {
                updateStatusMessage("âŒ ì¸ì¦ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.", "red");
            }
        }

        // âœ… ìƒíƒœ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateStatusMessage(message, color) {
            const statusMessage = document.getElementById("statusMessage");
            statusMessage.innerText = message;
            statusMessage.style.color = color;
        }

        // ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        document.getElementById("checkCookieButton").addEventListener("click", checkAuthStatus);
        document.getElementById("setCookieButton").addEventListener("click", setAuthCookie);
        document.getElementById("clearCookieButton").addEventListener("click", clearAuthCookie);

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¿ í‚¤ ë° CHIPS ì§€ì› ì—¬ë¶€ í™•ì¸
        checkThirdPartyCookies();
        checkCHIPS();
    </script>

</body>
</html>
